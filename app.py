import streamlit as st

st.set_page_config(layout="wide", page_title="Payroll Full Sheet")

# CSS Î³Î¹Î± ÎºÏŒÎºÎºÎ¹Î½Î¿ Ï‡ÏÏÎ¼Î± ÎºÎ±Î¹ ÏƒÏ„Î¿Î¯Ï‡Î¹ÏƒÎ·
st.markdown("""
    <style>
    .error-msg { color: #FF0000; font-weight: bold; }
    .row-style { border-bottom: 1px solid #e0e0e0; padding: 10px 0; }
    </style>
    """, unsafe_allow_html=True)

# --- Î”Î•Î”ÎŸÎœÎ•ÎÎ‘ ÎšÎ›Î™ÎœÎ‘ÎšÎ™Î©Î ---
klimakia_data = {
    "Î‘": 2589.31, "Î’": 2508.87, "Î“": 2428.41, "Î”": 2364.07,
    "1": 2234.94, "2": 2187.53, "3": 2087.69, "4": 1963.82,
    "5": 1892.43, "6": 1717.38, "7": 1667.92, "8": 1570.34,
    "9": 1454.83, "10": 1321.14, "11": 1309.80, "12": 1299.21,
    "13": 1285.07, "14": 1275.99, "15": 1266.41, "16": 1258.08,
    "17": 1224.28, "18": 1216.95, "19": 1202.63, "20": 1195.82,
    "21": 1195.82, "22": 1195.82, "23": 1195.82
}

st.title("ğŸ“Š Î‘Î½Î±Î»Ï…Ï„Î¹ÎºÎ® ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎœÎ¹ÏƒÎ¸Î¿Î´Î¿ÏƒÎ¯Î±Ï‚")

# --- Î“Î¡Î‘ÎœÎœÎ•Î£ 5-14 (Î‘Î ÎŸÎ”ÎŸÎ§Î•Î£) ---
with st.container():
    st.subheader("Î’Î‘Î£Î™ÎšÎ•Î£ Î‘Î ÎŸÎ”ÎŸÎ§Î•Î£ & Î•Î Î™Î”ÎŸÎœÎ‘Î¤Î‘")
    
    # 5: ÎœÎ™Î£Î˜ÎŸÎ›ÎŸÎ“Î™ÎšÎŸ ÎšÎ›Î™ÎœÎ‘ÎšÎ™ÎŸ
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d5_sel = c2.selectbox("D5 (Î•Ï€Î¹Î»Î¿Î³Î®)", list(klimakia_data.keys()))
    e5 = klimakia_data[d5_sel]
    c1.write("b5: ÎœÎ™Î£Î˜ÎŸÎ›ÎŸÎ“Î™ÎšÎŸ ÎšÎ›Î™ÎœÎ‘ÎšÎ™ÎŸ")
    c3.write(f"e5: **{e5:,.2f} â‚¬**")
    c4.write("f5: Î•Ï€Î¹Î»Î¿Î³Î® Î±Ï€ÏŒ D254:D280")

    # 6: Î§Î¡ÎŸÎÎŸÎ•Î Î™Î”ÎŸÎœÎ‘
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d6 = c2.number_input("D6 (Î‘ÎºÎ­ÏÎ±Î¹Î¿Ï‚ %)", step=1, value=0)
    e6 = e5 * (d6 / 100)
    c1.write("b6: Î§Î¡ÎŸÎÎŸÎ•Î Î™Î”ÎŸÎœÎ‘")
    c3.write(f"e6: **{e6:,.2f} â‚¬**")
    c4.write(f"f6: E5 * {d6}%")

    # 7: Î•Î Î™Î”ÎŸÎœÎ‘ Î“Î‘ÎœÎŸÎ¥
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d7_choice = c2.selectbox("D7 (Î“Î¬Î¼Î¿Ï‚)", ["ÎŸÎ§Î™", "ÎÎ‘Î™"])
    e7 = (e5 * 0.10) if d7_choice == "ÎÎ‘Î™" else 0.0
    c1.write("b7: Î•Î Î™Î”ÎŸÎœÎ‘ Î“Î‘ÎœÎŸÎ¥")
    c3.write(f"e7: **{e7:,.2f} â‚¬**")
    c4.write("f7: 10% ÎµÏ€Î¯ Ï„Î¿Ï… Î•5")

    # 9: Î ÎŸÎ›Î¥Î•Î¤Î™Î‘
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d9 = c2.number_input("D9 (Î Î¿Î»Ï…ÎµÏ„Î¯Î± - Î‘ÎºÎ­ÏÎ±Î¹Î¿Ï‚)", step=1, value=0)
    e9 = float(d9)
    c1.write("b9: Î ÎŸÎ›Î¥Î•Î¤Î™Î‘")
    c3.write(f"e9: **{e9:,.2f} â‚¬**")
    c4.write("f9: Î Î¿ÏƒÏŒ Ï€Î¿Î»Ï…ÎµÏ„Î¯Î±Ï‚")

    # 11: Î’Î‘Î£Î™ÎšÎŸÎ£ ÎœÎ™Î£Î˜ÎŸÎ£
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    e11 = e5 + e6
    c1.markdown("**b11: Î’Î‘Î£Î™ÎšÎŸÎ£ ÎœÎ™Î£Î˜ÎŸÎ£**")
    c3.markdown(f"**{e11:,.2f} â‚¬**")
    c4.write("f11: SUM(E5:E6)")

    # 12: Î Î¡ÎŸÎ£Î‘Î¥ÎÎ—Î£Î•Î™Î£ ÎœÎ™Î£Î˜ÎŸÎ¥
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    e12 = e7 + e9
    c1.markdown("**b12: Î Î¡ÎŸÎ£Î‘Î¥ÎÎ—Î£Î•Î™Î£ ÎœÎ™Î£Î˜ÎŸÎ¥**")
    c3.markdown(f"**{e12:,.2f} â‚¬**")
    c4.write("f12: Î†Î¸ÏÎ¿Î¹ÏƒÎ¼Î± ÎµÏ€Î¹Î´Î¿Î¼Î¬Ï„Ï‰Î½")

    # 14: ÎšÎ‘Î¤Î‘Î’Î‘Î›Î›ÎŸÎœÎ•ÎÎ•Î£ Î‘Î ÎŸÎ”ÎŸÎ§Î•Î£
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    e14 = e11 + e12
    c1.markdown("### b14: ÎšÎ‘Î¤Î‘Î’Î‘Î›Î›ÎŸÎœÎ•ÎÎ•Î£")
    c3.markdown(f"### {e14:,.2f} â‚¬")
    c4.write("f14: E11 + E12")

st.divider()

# --- Î“Î¡Î‘ÎœÎœÎ•Î£ 17-22 (Î’Î‘Î£Î— Î¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸÎ¥) ---
with st.container():
    st.subheader("Î©Î¡Î•Î£ & Î•Î Î™Î”ÎŸÎœÎ‘Î¤Î‘ Î’Î‘Î¡Î”Î™Î‘Î£")
    
    # 17, 18, 19
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d17 = c2.number_input("D17 (ÎÏÎµÏ‚ ÎšÎ±Î½.)", value=162.50, step=0.50)
    c1.write("b17: Î©Î¡Î•Î£ ÎšÎ‘Î. Î‘Î Î‘Î£Î§ÎŸÎ›Î—Î£Î—Î£")
    c4.write("f17: Î’Î¬ÏƒÎ· Î³Î¹Î± Ï‰ÏÎ¿Î¼Î¯ÏƒÎ¸Î¹Î¿")

    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d18 = c2.number_input("D18 (ÎÏÎµÏ‚ Î†Î´ÎµÎ¹Î±Ï‚)", value=0.0, step=0.50)
    c1.write("b18: Î©Î¡Î•Î£ Î‘Î”Î•Î™Î‘Î£")

    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d19 = c2.number_input("D19 (ÎÏÎµÏ‚ Î‘Ï€Î¿Ï…ÏƒÎ¯Î±Ï‚)", value=0.0, step=0.50)
    c1.write("b19: Î©Î¡Î•Î£ Î‘Î ÎŸÎ¥Î£Î™Î‘Î£")
    
    g19 = d17 + d18 + d19
    if g19 != 162.50:
        st.markdown(f'<p class="error-msg">âš ï¸ Î Î¡ÎŸÎ£ÎŸÎ§Î—: Î£ÏÎ½Î¿Î»Î¿ Î©ÏÏÎ½ {g19:.2f} (Î ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎµÎ¯Î½Î±Î¹ 162.50)</p>', unsafe_allow_html=True)

    # 21: Î•Î Î™Î”ÎŸÎœÎ‘ Î’Î‘Î¡Î”Î™Î‘Î£
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    c21_val = c2.number_input("C21 (ÎÏÎµÏ‚ Î’Î¬ÏÎ´Î¹Î±Ï‚)", value=162.50, step=0.5)
    e21 = 1570.34 * 0.1136
    c1.write("b21: Î•Î Î™Î”ÎŸÎœÎ‘ Î’Î‘Î¡Î”Î™Î‘Î£ (0201)")
    c3.write(f"e21: **{e21:,.2f} â‚¬**")
    c4.write("f21: 11,36% ÎµÏ€Î¯ Ï„Î¿Ï… 8Î¿Ï… ÎºÎ»Î¹Î¼Î±ÎºÎ¯Î¿Ï…")

    # 22: ÎŸÎ™ÎšÎŸÎ“Î•ÎÎ•Î™Î‘ÎšÎ‘ Î’Î‘Î¡Î—
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d22 = c2.selectbox("D22 (Î Î±Î¹Î´Î¹Î¬)", [0, 1, 2, 3, 4, 5])
    family_map = {0: 0, 1: 29.35, 2: 58.70, 3: 91.09, 4: 155.69, 5: 220.29}
    e22 = family_map[d22]
    c1.write("b22: Î•Î Î™Î”. ÎŸÎ™Îš. Î’Î‘Î¡Î©Î")
    c3.write(f"e22: **{e22:,.2f} â‚¬**")
    c4.write("f22: (1-2 Ï€. x 29,35 // 3Î¿ 32,39 // 4+ x 64,6)")

    # 177: Î©Î¡ÎŸÎœÎ™Î£Î˜Î™ÎŸ Î¥Î Î•Î¡Î©Î¡Î™Î©Î
    d177 = (e14 + e21 + e22) / d17 if d17 > 0 else 0.0
    st.success(f"Î“Î¡Î‘ÎœÎœÎ— 177 - Î©Î¡ÎŸÎœÎ™Î£Î˜Î™ÎŸ Î¥Î Î•Î¡Î©Î¡Î™Î©Î (D177): **{d177:.2f} â‚¬**")

st.divider()

# --- Î“Î¡Î‘ÎœÎœÎ•Î£ 29-36 (Î¥Î Î•Î¡Î©Î¡Î™Î•Î£ & ÎÎ¥Î§Î¤Î‘) ---
with st.container():
    st.subheader("Î¥Î Î•Î¡Î©Î¡Î™Î•Î£ & Î Î¡ÎŸÎ£Î‘Î¥ÎÎ—Î£Î•Î™Î£")
    
    for label, b_text, mult, f_text in [
        ("d29", "b29: 41 Î¥Î Î•Î¡Î•Î¡Î“Î‘Î£Î™Î‘ 20%", 1.20, "Î©ÏÎ¿Î¼Î¯ÏƒÎ¸Î¹Î¿ Î¥Ï€ÎµÏÏ‰ÏÎ¹ÏÎ½ x ÎÏÎµÏ‚ x 120%"),
        ("d30", "b30: Î¥Î Î•Î¡Î©Î¡Î™Î‘ Îœ.Î‘. 1,4", 1.40, "Î©ÏÎ¿Î¼Î¯ÏƒÎ¸Î¹Î¿ Î¥Ï€ÎµÏÏ‰ÏÎ¹ÏÎ½ x ÎÏÎµÏ‚ x 140%"),
        ("d31", "b31: 51 Î¥Î Î•Î¡Î©Î¡Î™Î‘ Î§.Î‘. 120%", 1.20, "Î©ÏÎ¿Î¼Î¯ÏƒÎ¸Î¹Î¿ Î¥Ï€ÎµÏÏ‰ÏÎ¹ÏÎ½ x ÎÏÎµÏ‚ x 120%")
    ]:
        c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
        hours = c2.number_input(f"{label} (ÎÏÎµÏ‚)", step=1, value=0)
        total = (d177 * hours) * mult
        c1.write(b_text)
        c3.write(f"**{total:,.2f} â‚¬**")
        c4.write(f"f{label[1:]}: {f_text}")

    st.write("---") # Î“ÏÎ±Î¼Î¼Î® 32 (ÎšÎµÎ½Î®)

    # ÎÎ¥Î§Î¤Î•Î¡Î™ÎÎ‘ 33-36
    c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
    d33 = c2.number_input("D33 (ÎÏÎµÏ‚ ÎÏÏ‡Ï„Î±Ï‚)", step=1)
    e33 = d33 * (e14 / 162.50) * 0.25
    c1.write("b33: Î Î¡ÎŸÎ£Î‘Î¥ÎÎ—Î£Î— ÎÎ¥Î§Î¤Î‘Î£")
    c3.write(f"**{e33:,.2f} â‚¬**")
    c4.write("f33: Î©ÏÎ¿Î¼Î¯ÏƒÎ¸Î¹Î¿ x ÎÏÎµÏ‚ x 25%")

    # 34, 35, 36 (Î£Ï…Î½ÎµÏ‡Î¯Î¶Î¿Ï…Î½ Î¼Îµ D177)
    for label, b_text, mult1, mult2, f_text in [
        ("d34", "b34: 43 Î Î¡ÎŸÎ£.Î¥Î Î•Î¡Î•Î¡Î“Î‘Î£Î™Î‘Î£ ÎÎ¥ÎšÎ¤Î‘Î£", 1.20, 0.25, "D177 x ÎÏÎµÏ‚ x 120% x 25%"),
        ("d35", "b35: Î Î¡ÎŸÎ£.Î¥Î Î•Î¡Î©Î¡Î™Î‘Î£ ÎÎ¥Î§Î¤Î‘Î£", 1.40, 0.25, "D177 x ÎÏÎµÏ‚ x 140% x 25%"),
        ("d36", "b36: Î Î¡ÎŸÎ£.Î¥Î Î•Î¡Î©Î¡Î™Î‘Î£ ÎÎ¥ÎšÎ¤Î‘Î£ Î§.Î‘.", 1.80, 0.25, "D177 x ÎÏÎµÏ‚ x 180% x 25%")
    ]:
        c1, c2, c3, c4 = st.columns([3, 2, 2, 4])
        h = c2.number_input(f"{label} (ÎÏÎµÏ‚)", step=1)
        res = (d177 * h) * mult1 * mult2
        c1.write(b_text)
        c3.write(f"**{res:,.2f} â‚¬**")
        c4.write(f"f{label[1:]}: {f_text}")

st.write("---") # Î“ÏÎ±Î¼Î¼Î® 37 (ÎšÎµÎ½Î®)
