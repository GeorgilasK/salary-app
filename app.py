import streamlit as st

st.set_page_config(page_title="Payroll App v8", layout="wide")

# --- Î”Î•Î”ÎŸÎœÎ•ÎÎ‘ ÎšÎ›Î™ÎœÎ‘ÎšÎ™Î©Î ---
klimakia_data = {
    "Î‘": 2589.31, "Î’": 2508.87, "Î“": 2428.41, "Î”": 2364.07,
    "1": 2234.94, "2": 2187.53, "3": 2087.69, "4": 1963.82,
    "5": 1892.43, "6": 1717.38, "7": 1667.92, "8": 1570.34,
    "9": 1454.83, "10": 1321.14, "11": 1309.80, "12": 1299.21,
    "13": 1285.07, "14": 1275.99, "15": 1266.41, "16": 1258.08,
    "17": 1224.28, "18": 1216.95, "19": 1202.63, "20": 1195.82,
    "21": 1195.82, "22": 1195.82, "23": 1195.82
}

st.title("ğŸ“Š ÎŸÎ»Î¿ÎºÎ»Î·ÏÏ‰Î¼Î­Î½Î¿ Î ÏÎ¿ÏƒÏ‡Î­Î´Î¹Î¿ ÎœÎ¹ÏƒÎ¸Î¿Î´Î¿ÏƒÎ¯Î±Ï‚")

# --- Î•ÎÎŸÎ¤Î—Î¤Î‘ 1: Î’Î‘Î£Î™ÎšÎ•Î£ Î‘Î ÎŸÎ”ÎŸÎ§Î•Î£ (5-14) ---
with st.container(border=True):
    st.subheader("ÎšÏÏÎ¹ÎµÏ‚ Î‘Ï€Î¿Î´Î¿Ï‡Î­Ï‚")
    c1, c2 = st.columns(2)
    with c1:
        d5_sel = st.selectbox("ÎœÎ¹ÏƒÎ¸Î¿Î»Î¿Î³Î¹ÎºÏŒ ÎšÎ»Î¹Î¼Î¬ÎºÎ¹Î¿ (D5):", list(klimakia_data.keys()))
        e5 = klimakia_data[d5_sel]
        d6 = st.number_input("Î§ÏÎ¿Î½Î¿ÎµÏ€Î¯Î´Î¿Î¼Î± % (D6) - Î‘ÎºÎ­ÏÎ±Î¹Î¿Ï‚", step=1, value=0)
        e6 = e5 * (d6 / 100)
        e11 = e5 + e6 # Î’11 Î’Î‘Î£Î™ÎšÎŸÎ£ ÎœÎ™Î£Î˜ÎŸÎ£
        st.info(f"**Î’11: Î’Î‘Î£Î™ÎšÎŸÎ£ ÎœÎ™Î£Î˜ÎŸÎ£ (E11): {e11:,.2f} â‚¬**")
    with c2:
        d7_choice = st.selectbox("Î•Î Î™Î”ÎŸÎœÎ‘ Î“Î‘ÎœÎŸÎ¥ (D7):", ["ÎŸÎ§Î™", "ÎÎ‘Î™"])
        e7 = (e5 * 0.10) if d7_choice == "ÎÎ‘Î™" else 0.0
        d9 = st.number_input("Î Î¿Î»Ï…ÎµÏ„Î¯Î± (D9) - Î‘ÎºÎ­ÏÎ±Î¹Î¿Ï‚", step=1, value=0)
        e9 = float(d9)
        e12 = e7 + e9 # B12 Î Î¡ÎŸÎ£Î‘Î¥ÎÎ—Î£Î•Î™Î£ ÎœÎ™Î£Î˜ÎŸÎ¥ (Î Î±ÏÎ±Î³ÏŒÎ¼ÎµÎ½Î¿)
        e14 = e11 + e12 # E14 ÎšÎ‘Î¤Î‘Î’Î‘Î›Î›ÎŸÎœÎ•ÎÎ•Î£
        st.metric("ÎšÎ±Ï„Î±Î²Î±Î»Î»ÏŒÎ¼ÎµÎ½ÎµÏ‚ Î‘Ï€Î¿Î´Î¿Ï‡Î­Ï‚ (E14)", f"{e14:.2f} â‚¬")

# --- Î•ÎÎŸÎ¤Î—Î¤Î‘ 2: Î©Î¡Î•Î£ & Î©Î¡ÎŸÎœÎ™Î£Î˜Î™Î‘ (17-22) ---
with st.container(border=True):
    st.subheader("ğŸ•’ Î£Ï„Î¿Î¹Ï‡ÎµÎ¯Î± Î©ÏÎ±ÏÎ¯Î¿Ï… & Î’Î¬ÏƒÎ·Ï‚ Î¥Ï€ÎµÏÏ‰ÏÎ¹ÏÎ½")
    cols = st.columns(3)
    d17 = cols[0].number_input("ÎÏÎµÏ‚ ÎšÎ±Î½. Î‘Ï€Î±ÏƒÏ‡ÏŒÎ»Î·ÏƒÎ·Ï‚ (D17)", value=162.50, step=0.50)
    d18 = cols[1].number_input("ÎÏÎµÏ‚ Î†Î´ÎµÎ¹Î±Ï‚ (D18)", value=0.0, step=0.50)
    d19 = cols[2].number_input("ÎÏÎµÏ‚ Î‘Ï€Î¿Ï…ÏƒÎ¯Î±Ï‚ (D19)", value=0.0, step=0.50)
    
    # Î“ÏÎ±Î¼Î¼Î® 21
    st.divider()
    v_col1, v_col2 = st.columns(2)
    with v_col1:
        c21 = st.number_input("Î’21: Î©Î¡Î•Î£ Î’Î‘Î¡Î”Î™Î‘Î£ (C21):", value=162.5, step=0.5)
        e21 = 1570.34 * 0.1136 # Î’Î¬ÏƒÎµÎ¹ 8Î¿Ï… ÎºÎ»Î¹Î¼Î±ÎºÎ¯Î¿Ï…
        st.write(f"Î Î¿ÏƒÏŒ Î•Ï€Î¹Î´. Î’Î¬ÏÎ´Î¹Î±Ï‚ (E21): {e21:.2f} â‚¬")
    with v_col2:
        d22 = st.selectbox("Î’22: Î‘Î¡Î™Î˜ÎœÎŸÎ£ Î Î‘Î™Î”Î™Î©Î (D22):", [0, 1, 2, 3, 4, 5])
        family_map = {0: 0, 1: 29.35, 2: 58.70, 3: 91.09, 4: 155.69, 5: 220.29}
        e22 = family_map[d22]
        st.write(f"Î Î¿ÏƒÏŒ ÎŸÎ¹Îº. Î’Î±ÏÏÎ½ (E22): {e22:.2f} â‚¬")

    # Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ D177
    d177 = (e14 + e21 + e22) / d17 if d17 > 0 else 0.0
    st.success(f"**Î©ÏÎ¿Î¼Î¯ÏƒÎ¸Î¹Î¿ Î¥Ï€ÎµÏÏ‰ÏÎ¹ÏÎ½ (D177): {d177:.4f} â‚¬**")

# --- Î•ÎÎŸÎ¤Î—Î¤Î‘ 3: Î¥Î Î•Î¡Î©Î¡Î™Î•Î£ & ÎÎ¥Î§Î¤Î•Î¡Î™ÎÎ‘ (29-36) ---
st.write("---") # Î“ÏÎ±Î¼Î¼Î® 32 (ÎšÎµÎ½Î®)
with st.container(border=True):
    st.subheader("âš¡ Î¥Ï€ÎµÏÏ‰ÏÎ¯ÎµÏ‚ & ğŸŒ™ ÎÏ…Ï‡Ï„ÎµÏÎ¹Î½Î¬")
    u1, u2, u3 = st.columns(3)
    d29 = u1.number_input("41 Î¥Î Î•Î¡Î•Î¡Î“Î‘Î£Î™Î‘ 20% (B29)", step=1, value=0)
    d30 = u2.number_input("Î¥Î Î•Î¡Î©Î¡Î™Î‘ Îœ.Î‘. 1,4 (B30)", step=1, value=0)
    d31 = u3.number_input("51 Î¥Î Î•Î¡Î©Î¡Î™Î‘ Î§.Î‘. 120% (B31)", step=1, value=0)

    # Î¥Ï€Î¿Ï€Î»Î±Î¯ÏƒÎ¹Î¿ ÎÏ…Ï‡Ï„ÎµÏÎ¹Î½ÏÎ½
    with st.expander("Î‘Î½Î¬Î»Ï…ÏƒÎ· Î ÏÎ¿ÏƒÎ±Ï…Î¾Î®ÏƒÎµÏ‰Î½ ÎÏÏ‡Ï„Î±Ï‚ (33-36)", expanded=True):
        n1, n2, n3, n4 = st.columns(4)
        d33 = n1.number_input("ÎÏÎµÏ‚ ÎÏÏ‡Ï„Î±Ï‚ (D33)", step=1)
        d34 = n2.number_input("ÎÏÎµÏ‚ Î¥Ï€ÎµÏÎµÏÎ³. ÎÏÏ‡Ï„Î±Ï‚ (D34)", step=1)
        d35 = n3.number_input("ÎÏÎµÏ‚ Î¥Ï€ÎµÏÏ‰Ï. ÎÏÏ‡Ï„Î±Ï‚ (D35)", step=1)
        d36 = n4.number_input("ÎÏÎµÏ‚ Î¥Ï€ÎµÏÏ‰Ï. Î§.Î‘. ÎÏÏ‡Ï„Î±Ï‚ (D36)", step=1)

# --- Î•ÎÎŸÎ¤Î—Î¤Î‘ 4: Î¤Î•Î›Î™ÎšÎŸ Î£Î¤Î‘Î”Î™ÎŸ (38-43) ---
st.write("---") # Î“ÏÎ±Î¼Î¼Î® 37 (ÎšÎµÎ½Î®)
st.warning("Î‘Î½Î±Î¼Î¿Î½Î® Î³Î¹Î± Î“ÏÎ±Î¼Î¼Î­Ï‚ 38-43...")

# Î“ÏÎ±Î¼Î¼Î® 182 (Î‘Ï€Î¿Î¶Î·Î¼Î¯Ï‰ÏƒÎ· Î¤ÏÎ¿Ï†Î®Ï‚)
g19 = d17 + d18 + d19
e182 = (g19 / 6.66) * 5.40
st.write(f"Î‘Ï€Î¿Î¶Î·Î¼Î¯Ï‰ÏƒÎ· Î¤ÏÎ¿Ï†Î®Ï‚ (E182): **{e182:.2f} â‚¬**")
